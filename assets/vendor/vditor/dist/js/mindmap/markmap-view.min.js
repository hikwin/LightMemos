/**
 * Minified by jsDelivr using Terser v5.39.0.
 * Original file: /npm/markmap-view@0.15.3/dist/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
/*! markmap-view v0.15.3 | MIT License */
import{Hook,getId,addClass,walkTree,childSelector,noop}from"markmap-common";export{loadCSS,loadJS}from"markmap-common";import{scaleOrdinal,schemeCategory10,zoomTransform,select,zoom,linkHorizontal,min,max,zoomIdentity,minIndex}from"d3";function _extends(){return _extends=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},_extends.apply(this,arguments)}function count(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function node_count(){return this.eachAfter(count)}function node_each(t){var e,n,r,o,i=this,a=[i];do{for(e=a.reverse(),a=[];i=e.pop();)if(t(i),n=i.children)for(r=0,o=n.length;r<o;++r)a.push(n[r])}while(a.length);return this}function node_eachBefore(t){for(var e,n,r=this,o=[r];r=o.pop();)if(t(r),e=r.children)for(n=e.length-1;n>=0;--n)o.push(e[n]);return this}function node_eachAfter(t){for(var e,n,r,o=this,i=[o],a=[];o=i.pop();)if(a.push(o),e=o.children)for(n=0,r=e.length;n<r;++n)i.push(e[n]);for(;o=a.pop();)t(o);return this}function node_sum(t){return this.eachAfter((function(e){for(var n=+t(e.data)||0,r=e.children,o=r&&r.length;--o>=0;)n+=r[o].value;e.value=n}))}function node_sort(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))}function node_path(t){for(var e=this,n=leastCommonAncestor(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var o=r.length;t!==n;)r.splice(o,0,t),t=t.parent;return r}function leastCommonAncestor(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),o=null;for(t=n.pop(),e=r.pop();t===e;)o=t,t=n.pop(),e=r.pop();return o}function node_ancestors(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e}function node_descendants(){var t=[];return this.each((function(e){t.push(e)})),t}function node_leaves(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t}function node_links(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e}function hierarchy(t,e){var n,r,o,i,a,s=new Node$1(t),l=+t.value&&(s.value=t.value),h=[s];for(null==e&&(e=defaultChildren);n=h.pop();)if(l&&(n.value=+n.data.value),(o=e(n.data))&&(a=o.length))for(n.children=new Array(a),i=a-1;i>=0;--i)h.push(r=n.children[i]=new Node$1(o[i])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(computeHeight)}function node_copy(){return hierarchy(this).eachBefore(copyData)}function defaultChildren(t){return t.children}function copyData(t){t.data=t.data.data}function computeHeight(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function Node$1(t){this.data=t,this.depth=this.height=0,this.parent=null}Node$1.prototype=hierarchy.prototype={constructor:Node$1,count:node_count,each:node_each,eachAfter:node_eachAfter,eachBefore:node_eachBefore,sum:node_sum,sort:node_sort,path:node_path,ancestors:node_ancestors,descendants:node_descendants,leaves:node_leaves,links:node_links,copy:node_copy};var name="d3-flextree",version$1="2.1.2",main="build/d3-flextree.js",module="index",author={name:"Chris Maloney",url:"http://chrismaloney.org"},description="Flexible tree layout algorithm that allows for variable node sizes.",keywords=["d3","d3-module","layout","tree","hierarchy","d3-hierarchy","plugin","d3-plugin","infovis","visualization","2d"],homepage="https://github.com/klortho/d3-flextree",license="WTFPL",repository={type:"git",url:"https://github.com/klortho/d3-flextree.git"},scripts={clean:"rm -rf build demo test","build:demo":"rollup -c --environment BUILD:demo","build:dev":"rollup -c --environment BUILD:dev","build:prod":"rollup -c --environment BUILD:prod","build:test":"rollup -c --environment BUILD:test",build:"rollup -c",lint:"eslint index.js src","test:main":"node test/bundle.js","test:browser":"node test/browser-tests.js",test:"npm-run-all test:*",prepare:"npm-run-all clean build lint test"},dependencies={"d3-hierarchy":"^1.1.5"},devDependencies={"babel-plugin-external-helpers":"^6.22.0","babel-preset-es2015-rollup":"^3.0.0",d3:"^4.13.0","d3-selection-multi":"^1.0.1",eslint:"^4.19.1",jsdom:"^11.6.2","npm-run-all":"^4.1.2",rollup:"^0.55.3","rollup-plugin-babel":"^2.7.1","rollup-plugin-commonjs":"^8.0.2","rollup-plugin-copy":"^0.2.3","rollup-plugin-json":"^2.3.0","rollup-plugin-node-resolve":"^3.0.2","rollup-plugin-uglify":"^3.0.0","uglify-es":"^3.3.9"},packageInfo={name:name,version:version$1,main:main,module:module,"jsnext:main":"index",author:author,description:description,keywords:keywords,homepage:homepage,license:license,repository:repository,scripts:scripts,dependencies:dependencies,devDependencies:devDependencies};const{version:version}=packageInfo,defaults=Object.freeze({children:t=>t.children,nodeSize:t=>t.data.size,spacing:0});function flextree(t){const e=Object.assign({},defaults,t);function n(t){const n=e[t];return"function"==typeof n?n:()=>n}function r(t){const e=i(function(){const t=o(),e=n("nodeSize"),r=n("spacing");return class extends t{constructor(t){super(t),Object.assign(this,{x:0,y:0,relX:0,prelim:0,shift:0,change:0,lExt:this,lExtRelX:0,lThr:null,rExt:this,rExtRelX:0,rThr:null})}get size(){return e(this.data)}spacing(t){return r(this.data,t.data)}get x(){return this.data.x}set x(t){this.data.x=t}get y(){return this.data.y}set y(t){this.data.y=t}update(){return layoutChildren(this),resolveX(this),this}}}(),t,(t=>t.children));return e.update(),e.data}function o(){const t=n("nodeSize"),e=n("spacing");return class n extends hierarchy.prototype.constructor{constructor(t){super(t)}copy(){const t=i(this.constructor,this,(t=>t.children));return t.each((t=>t.data=t.data.data)),t}get size(){return t(this)}spacing(t){return e(this,t)}get nodes(){return this.descendants()}get xSize(){return this.size[0]}get ySize(){return this.size[1]}get top(){return this.y}get bottom(){return this.y+this.ySize}get left(){return this.x-this.xSize/2}get right(){return this.x+this.xSize/2}get root(){const t=this.ancestors();return t[t.length-1]}get numChildren(){return this.hasChildren?this.children.length:0}get hasChildren(){return!this.noChildren}get noChildren(){return null===this.children}get firstChild(){return this.hasChildren?this.children[0]:null}get lastChild(){return this.hasChildren?this.children[this.numChildren-1]:null}get extents(){return(this.children||[]).reduce(((t,e)=>n.maxExtents(t,e.extents)),this.nodeExtents)}get nodeExtents(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}static maxExtents(t,e){return{top:Math.min(t.top,e.top),bottom:Math.max(t.bottom,e.bottom),left:Math.min(t.left,e.left),right:Math.max(t.right,e.right)}}}}function i(t,e,n){const r=(e,o)=>{const i=new t(e);Object.assign(i,{parent:o,depth:null===o?0:o.depth+1,height:0,length:1});const a=n(e)||[];return i.children=0===a.length?null:a.map((t=>r(t,i))),i.children&&Object.assign(i,i.children.reduce(((t,e)=>({height:Math.max(t.height,e.height+1),length:t.length+e.length})),i)),i};return r(e,null)}return Object.assign(r,{nodeSize(t){return arguments.length?(e.nodeSize=t,r):e.nodeSize},spacing(t){return arguments.length?(e.spacing=t,r):e.spacing},children(t){return arguments.length?(e.children=t,r):e.children},hierarchy(t,n){const r=void 0===n?e.children:n;return i(o(),t,r)},dump(t){const e=n("nodeSize"),r=t=>n=>{const o=t+"  ",i=t+"    ",{x:a,y:s}=n,l=e(n),h=n.children||[],c=0===h.length?" ":`,${o}children: [${i}${h.map(r(i)).join(i)}${o}],${t}`;return`{ size: [${l.join(", ")}],${o}x: ${a}, y: ${s}${c}},`};return r("\n")(t)}}),r}flextree.version=version;const layoutChildren=(t,e=0)=>(t.y=e,(t.children||[]).reduce(((e,n)=>{const[r,o]=e;layoutChildren(n,t.y+t.ySize);const i=(0===r?n.lExt:n.rExt).bottom;0!==r&&separate(t,r,o);return[r+1,updateLows(i,r,o)]}),[0,null]),shiftChange(t),positionRoot(t),t),resolveX=(t,e,n)=>{void 0===e&&(e=-t.relX-t.prelim,n=0);const r=e+t.relX;return t.relX=r+t.prelim-n,t.prelim=0,t.x=n+t.relX,(t.children||[]).forEach((e=>resolveX(e,r,t.x))),t},shiftChange=t=>{(t.children||[]).reduce(((t,e)=>{const[n,r]=t,o=n+e.shift,i=r+o+e.change;return e.relX+=i,[o,i]}),[0,0])},separate=(t,e,n)=>{const r=t.children[e-1],o=t.children[e];let i=r,a=r.relX,s=o,l=o.relX,h=!0;for(;i&&s;){i.bottom>n.lowY&&(n=n.next);const r=a+i.prelim-(l+s.prelim)+i.xSize/2+s.xSize/2+i.spacing(s);(r>0||r<0&&h)&&(l+=r,moveSubtree(o,r),distributeExtra(t,e,n.index,r)),h=!1;const c=i.bottom,d=s.bottom;c<=d&&(i=nextRContour(i),i&&(a+=i.relX)),c>=d&&(s=nextLContour(s),s&&(l+=s.relX))}!i&&s?setLThr(t,e,s,l):i&&!s&&setRThr(t,e,i,a)},moveSubtree=(t,e)=>{t.relX+=e,t.lExtRelX+=e,t.rExtRelX+=e},distributeExtra=(t,e,n,r)=>{const o=t.children[e],i=e-n;if(i>1){const e=r/i;t.children[n+1].shift+=e,o.shift-=e,o.change-=r-e}},nextLContour=t=>t.hasChildren?t.firstChild:t.lThr,nextRContour=t=>t.hasChildren?t.lastChild:t.rThr,setLThr=(t,e,n,r)=>{const o=t.firstChild,i=o.lExt,a=t.children[e];i.lThr=n;const s=r-n.relX-o.lExtRelX;i.relX+=s,i.prelim-=s,o.lExt=a.lExt,o.lExtRelX=a.lExtRelX},setRThr=(t,e,n,r)=>{const o=t.children[e],i=o.rExt,a=t.children[e-1];i.rThr=n;const s=r-n.relX-o.rExtRelX;i.relX+=s,i.prelim-=s,o.rExt=a.rExt,o.rExtRelX=a.rExtRelX},positionRoot=t=>{if(t.hasChildren){const e=t.firstChild,n=t.lastChild,r=(e.prelim+e.relX-e.xSize/2+n.relX+n.prelim+n.xSize/2)/2;Object.assign(t,{prelim:r,lExt:e.lExt,lExtRelX:e.lExtRelX,rExt:n.rExt,rExtRelX:n.rExtRelX})}},updateLows=(t,e,n)=>{for(;null!==n&&t>=n.lowY;)n=n.next;return{lowY:t,index:e,next:n}},VTYPE_ELEMENT=1,VTYPE_FUNCTION=2,SVG_NS="http://www.w3.org/2000/svg",XLINK_NS="http://www.w3.org/1999/xlink",NS_ATTRS={show:XLINK_NS,actuate:XLINK_NS,href:XLINK_NS},isLeaf=t=>"string"==typeof t||"number"==typeof t,isElement=t=>1===(null==t?void 0:t.vtype),isRenderFunction=t=>2===(null==t?void 0:t.vtype);function jsx(t,e){let n;if("string"==typeof t)n=1;else{if("function"!=typeof t)throw new Error("Invalid VNode type");n=2}return{vtype:n,type:t,props:e}}function Fragment(t){return t.children}const DEFAULT_ENV={isSvg:!1};function insertDom(t,e){Array.isArray(e)||(e=[e]),(e=e.filter(Boolean)).length&&t.append(...e)}function mountAttributes(t,e,n){for(const r in e)if("key"!==r&&"children"!==r&&"ref"!==r)if("dangerouslySetInnerHTML"===r)t.innerHTML=e[r].__html;else if("innerHTML"===r||"textContent"===r||"innerText"===r||"value"===r&&["textarea","select"].includes(t.tagName)){const n=e[r];null!=n&&(t[r]=n)}else r.startsWith("on")?t[r.toLowerCase()]=e[r]:setDOMAttribute(t,r,e[r],n.isSvg)}const attrMap={className:"class",labelFor:"for"};function setDOMAttribute(t,e,n,r){if(e=attrMap[e]||e,!0===n)t.setAttribute(e,"");else if(!1===n)t.removeAttribute(e);else{const o=r?NS_ATTRS[e]:void 0;void 0!==o?t.setAttributeNS(o,e,n):t.setAttribute(e,n)}}function flatten(t){return t.reduce(((t,e)=>t.concat(e)),[])}function mountChildren(t,e){return Array.isArray(t)?flatten(t.map((t=>mountChildren(t,e)))):mount(t,e)}function mount(t,e=DEFAULT_ENV){if(null==t||"boolean"==typeof t)return null;if(t instanceof Node)return t;if(isRenderFunction(t)){const{type:n,props:r}=t;if(n===Fragment){const t=document.createDocumentFragment();if(r.children){insertDom(t,mountChildren(r.children,e))}return t}return mount(n(r),e)}if(isLeaf(t))return document.createTextNode(`${t}`);if(isElement(t)){let n;const{type:r,props:o}=t;if(e.isSvg||"svg"!==r||(e=Object.assign({},e,{isSvg:!0})),n=e.isSvg?document.createElementNS(SVG_NS,r):document.createElement(r),mountAttributes(n,o,e),o.children){let t=e;e.isSvg&&"foreignObject"===r&&(t=Object.assign({},t,{isSvg:!1}));const i=mountChildren(o.children,t);null!=i&&insertDom(n,i)}const{ref:i}=o;return"function"==typeof i&&i(n),n}throw new Error("mount: Invalid Vnode!")}function mountDom(t){return mount(t)}var css_248z$1=".markmap{font:300 16px/20px sans-serif}.markmap-link{fill:none}.markmap-node>circle{cursor:pointer}.markmap-foreign{display:inline-block}.markmap-foreign a{color:#0097e6}.markmap-foreign a:hover{color:#00a8ff}.markmap-foreign code{background-color:#f0f0f0;border-radius:2px;color:#555;font-size:calc(1em - 2px);padding:.25em}.markmap-foreign pre{margin:0}.markmap-foreign pre>code{display:block}.markmap-foreign del{text-decoration:line-through}.markmap-foreign em{font-style:italic}.markmap-foreign strong{font-weight:700}.markmap-foreign mark{background:#ffeaa7}",css_248z=".markmap-container{height:0;left:-100px;overflow:hidden;position:absolute;top:-100px;width:0}.markmap-container>.markmap-foreign{display:inline-block}.markmap-container>.markmap-foreign>div:last-child{white-space:nowrap}";const globalCSS=css_248z$1;function linkWidth(t){const e=t.data;return Math.max(4-2*e.depth,1.5)}function minBy(t,e){return t[minIndex(t,e)]}function stopPropagation(t){t.stopPropagation()}function createViewHooks(){return{transformHtml:new Hook}}const refreshHook=new Hook,defaultColorFn=scaleOrdinal(schemeCategory10),isMacintosh="undefined"!=typeof navigator&&navigator.userAgent.includes("Macintosh");class Markmap{constructor(t,e){this.options=Markmap.defaultOptions,this.revokers=[],this.handleZoom=t=>{const{transform:e}=t;this.g.attr("transform",e)},this.handlePan=t=>{t.preventDefault();const e=zoomTransform(this.svg.node()),n=e.translate(-t.deltaX/e.k,-t.deltaY/e.k);this.svg.call(this.zoom.transform,n)},this.handleClick=(t,e)=>{let n=this.options.toggleRecursively;(isMacintosh?t.metaKey:t.ctrlKey)&&(n=!n),this.toggleNode(e.data,n)},this.viewHooks=createViewHooks(),this.svg=t.datum?t:select(t),this.styleNode=this.svg.append("style"),this.zoom=zoom().filter((t=>this.options.scrollForPan&&"wheel"===t.type?t.ctrlKey&&!t.button:!(t.ctrlKey&&"wheel"!==t.type||t.button))).on("zoom",this.handleZoom),this.setOptions(e),this.state={id:this.options.id||this.svg.attr("id")||getId(),minX:0,maxX:0,minY:0,maxY:0},this.g=this.svg.append("g"),this.revokers.push(refreshHook.tap((()=>{this.setData()})))}getStyleContent(){const{style:t}=this.options,{id:e}=this.state,n="function"==typeof t?t(e):"";return[this.options.embedGlobalCSS&&css_248z$1,n].filter(Boolean).join("\n")}updateStyle(){this.svg.attr("class",addClass(this.svg.attr("class"),"markmap",this.state.id));const t=this.getStyleContent();this.styleNode.text(t)}toggleNode(t,e=!1){var n;const r=null!=(n=t.payload)&&n.fold?0:1;var o;e?walkTree(t,((t,e)=>{t.payload=_extends({},t.payload,{fold:r}),e()})):t.payload=_extends({},t.payload,{fold:null!=(o=t.payload)&&o.fold?0:1});this.renderData(t)}initializeData(t){let e=0;const{color:n,nodeMinHeight:r,maxWidth:o,initialExpandLevel:i}=this.options,{id:a}=this.state,s=mountDom(jsx("div",{className:`markmap-container markmap ${a}-g`})),l=mountDom(jsx("style",{children:[this.getStyleContent(),css_248z].join("\n")}));document.body.append(s,l);const h=o?`max-width: ${o}px`:"";let c=0;walkTree(t,((t,r,o)=>{var a,l,d;t.children=null==(a=t.children)?void 0:a.map((t=>_extends({},t))),e+=1;const u=mountDom(jsx("div",{className:"markmap-foreign",style:h,children:jsx("div",{dangerouslySetInnerHTML:{__html:t.content}})}));s.append(u),t.state=_extends({},t.state,{id:e,el:u.firstChild}),t.state.path=[null==o||null==(l=o.state)?void 0:l.path,t.state.id].filter(Boolean).join("."),n(t);const p=2===(null==(d=t.payload)?void 0:d.fold);p?c+=1:(c||i>=0&&t.depth>=i)&&(t.payload=_extends({},t.payload,{fold:1})),r(),p&&(c-=1)}));const d=Array.from(s.childNodes).map((t=>t.firstChild));this.viewHooks.transformHtml.call(this,d),d.forEach((t=>{var e;null==(e=t.parentNode)||e.append(t.cloneNode(!0))})),walkTree(t,((t,e,n)=>{var o;const i=t.state,a=i.el.getBoundingClientRect();t.content=i.el.innerHTML,i.size=[Math.ceil(a.width)+1,Math.max(Math.ceil(a.height),r)],i.key=[null==n||null==(o=n.state)?void 0:o.id,i.id].filter(Boolean).join(".")+t.content,e()})),s.remove(),l.remove()}setOptions(t){this.options=_extends({},this.options,t),this.options.zoom?this.svg.call(this.zoom):this.svg.on(".zoom",null),this.options.pan?this.svg.on("wheel",this.handlePan):this.svg.on("wheel",null)}setData(t,e){e&&this.setOptions(e),t&&(this.state.data=t),this.state.data&&(this.initializeData(this.state.data),this.updateStyle(),this.renderData())}renderData(t){var e,n;if(!this.state.data)return;const{spacingHorizontal:r,paddingX:o,spacingVertical:i,autoFit:a,color:s}=this.options,l=flextree({}).children((t=>{var e;if(null==(e=t.payload)||!e.fold)return t.children})).nodeSize((t=>{const[e,n]=t.data.state.size;return[n,e+(e?2*o:0)+r]})).spacing(((t,e)=>t.parent===e.parent?i:2*i)),h=l.hierarchy(this.state.data);l(h);const c=h.descendants().reverse(),d=h.links(),u=linkHorizontal(),p=min(c,(t=>t.x-t.xSize/2)),m=max(c,(t=>t.x+t.xSize/2)),f=min(c,(t=>t.y)),g=max(c,(t=>t.y+t.ySize-r));Object.assign(this.state,{minX:p,maxX:m,minY:f,maxY:g}),a&&this.fit();const x=t&&c.find((e=>e.data===t))||h,y=null!=(e=x.data.state.x0)?e:x.x,v=null!=(n=x.data.state.y0)?n:x.y,k=this.g.selectAll(childSelector("g")).data(c,(t=>t.data.state.key)),S=k.enter().append("g").attr("data-depth",(t=>t.data.depth)).attr("data-path",(t=>t.data.state.path)).attr("transform",(t=>`translate(${v+x.ySize-t.ySize},${y+x.xSize/2-t.xSize})`)),z=this.transition(k.exit());z.select("line").attr("x1",(t=>t.ySize-r)).attr("x2",(t=>t.ySize-r)),z.select("foreignObject").style("opacity",0),z.attr("transform",(t=>`translate(${x.y+x.ySize-t.ySize},${x.x+x.xSize/2-t.xSize})`)).remove();const b=k.merge(S).attr("class",(t=>{var e;return["markmap-node",(null==(e=t.data.payload)?void 0:e.fold)&&"markmap-fold"].filter(Boolean).join(" ")}));this.transition(b).attr("transform",(t=>`translate(${t.y},${t.x-t.xSize/2})`));const w=b.selectAll(childSelector("line")).data((t=>[t]),(t=>t.data.state.key)).join((t=>t.append("line").attr("x1",(t=>t.ySize-r)).attr("x2",(t=>t.ySize-r))),(t=>t),(t=>t.remove()));this.transition(w).attr("x1",-1).attr("x2",(t=>t.ySize-r+2)).attr("y1",(t=>t.xSize)).attr("y2",(t=>t.xSize)).attr("stroke",(t=>s(t.data))).attr("stroke-width",linkWidth);const C=b.selectAll(childSelector("circle")).data((t=>{var e;return null!=(e=t.data.children)&&e.length?[t]:[]}),(t=>t.data.state.key)).join((t=>t.append("circle").attr("stroke-width","1.5").attr("cx",(t=>t.ySize-r)).attr("cy",(t=>t.xSize)).attr("r",0).on("click",((t,e)=>this.handleClick(t,e))).on("mousedown",stopPropagation)),(t=>t),(t=>t.remove()));this.transition(C).attr("r",6).attr("cx",(t=>t.ySize-r)).attr("cy",(t=>t.xSize)).attr("stroke",(t=>s(t.data))).attr("fill",(t=>{var e;return null!=(e=t.data.payload)&&e.fold&&t.data.children?s(t.data):"#fff"}));const E=b.selectAll(childSelector("foreignObject")).data((t=>[t]),(t=>t.data.state.key)).join((t=>{const e=t.append("foreignObject").attr("class","markmap-foreign").attr("x",o).attr("y",0).style("opacity",0).on("mousedown",stopPropagation).on("dblclick",stopPropagation);return e.append("xhtml:div").select((function(t){const e=t.data.state.el.cloneNode(!0);return this.replaceWith(e),e})).attr("xmlns","http://www.w3.org/1999/xhtml"),e}),(t=>t),(t=>t.remove())).attr("width",(t=>Math.max(0,t.ySize-r-2*o))).attr("height",(t=>t.xSize));this.transition(E).style("opacity",1);const _=this.g.selectAll(childSelector("path")).data(d,(t=>t.target.data.state.key)).join((t=>{const e=[v+x.ySize-r,y+x.xSize/2];return t.insert("path","g").attr("class","markmap-link").attr("data-depth",(t=>t.target.data.depth)).attr("data-path",(t=>t.target.data.state.path)).attr("d",u({source:e,target:e}))}),(t=>t),(t=>{const e=[x.y+x.ySize-r,x.x+x.xSize/2];return this.transition(t).attr("d",u({source:e,target:e})).remove()}));this.transition(_).attr("stroke",(t=>s(t.target.data))).attr("stroke-width",(t=>linkWidth(t.target))).attr("d",(t=>{const e=t.source,n=t.target,o=[e.y+e.ySize-r,e.x+e.xSize/2],i=[n.y,n.x+n.xSize/2];return u({source:o,target:i})})),c.forEach((t=>{t.data.state.x0=t.x,t.data.state.y0=t.y}))}transition(t){const{duration:e}=this.options;return t.transition().duration(e)}async fit(){const t=this.svg.node(),{width:e,height:n}=t.getBoundingClientRect(),{fitRatio:r}=this.options,{minX:o,maxX:i,minY:a,maxY:s}=this.state,l=s-a,h=i-o,c=Math.min(e/l*r,n/h*r,2),d=zoomIdentity.translate((e-l*c)/2-a*c,(n-h*c)/2-o*c).scale(c);return this.transition(this.svg).call(this.zoom.transform,d).end().catch(noop)}async ensureView(t,e){let n;if(this.g.selectAll(childSelector("g")).each((function(e){e.data===t&&(n=e)})),!n)return;const r=this.svg.node(),{spacingHorizontal:o}=this.options,i=r.getBoundingClientRect(),a=zoomTransform(r),[s,l]=[n.y,n.y+n.ySize-o+2].map((t=>t*a.k+a.x)),[h,c]=[n.x-n.xSize/2,n.x+n.xSize/2].map((t=>t*a.k+a.y)),d=_extends({left:0,right:0,top:0,bottom:0},e),u=[d.left-s,i.width-d.right-l],p=[d.top-h,i.height-d.bottom-c],m=u[0]*u[1]>0?minBy(u,Math.abs)/a.k:0,f=p[0]*p[1]>0?minBy(p,Math.abs)/a.k:0;if(m||f){const t=a.translate(m,f);return this.transition(this.svg).call(this.zoom.transform,t).end().catch(noop)}}async rescale(t){const e=this.svg.node(),{width:n,height:r}=e.getBoundingClientRect(),o=n/2,i=r/2,a=zoomTransform(e),s=a.translate((o-a.x)*(1-t)/a.k,(i-a.y)*(1-t)/a.k).scale(t);return this.transition(this.svg).call(this.zoom.transform,s).end().catch(noop)}destroy(){this.svg.on(".zoom",null),this.svg.html(null),this.revokers.forEach((t=>{t()}))}static create(t,e,n=null){const r=new Markmap(t,e);return n&&(r.setData(n),r.fit()),r}}function deriveOptions(t){const e={},n=_extends({},t),{color:r,colorFreezeLevel:o}=n;if(1===(null==r?void 0:r.length)){const t=r[0];e.color=()=>t}else if(null!=r&&r.length){const t=scaleOrdinal(r);e.color=e=>t(`${e.state.path}`)}if(o){const t=e.color||Markmap.defaultOptions.color;e.color=e=>(e=_extends({},e,{state:_extends({},e.state,{path:e.state.path.split(".").slice(0,o).join(".")})}),t(e))}["duration","maxWidth","initialExpandLevel"].forEach((t=>{const r=n[t];"number"==typeof r&&(e[t]=r)}));return["zoom","pan"].forEach((t=>{const r=n[t];null!=r&&(e[t]=!!r)})),e}Markmap.defaultOptions={autoFit:!1,color:t=>{var e;return defaultColorFn(`${(null==(e=t.state)?void 0:e.path)||""}`)},duration:500,embedGlobalCSS:!0,fitRatio:.95,maxWidth:0,nodeMinHeight:16,paddingX:8,scrollForPan:isMacintosh,spacingHorizontal:80,spacingVertical:5,initialExpandLevel:-1,zoom:!0,pan:!0,toggleRecursively:!1};export{Markmap,defaultColorFn,deriveOptions,globalCSS,refreshHook};
//# sourceMappingURL=/sm/a313376ac766d3a5c0abde333dee51100066a152a4f8f38b900140696c0288a9.map